/* */
'use strict';

System.register([], function (_export, _context) {
  var $, ctx, $export, createDesc, assign, keyOf, aFunction, forOf, isIterable, $iterCreate, step, isObject, toIObject, DESCRIPTORS, has, getKeys, createDictMethod, findKey, createDictIter, DictIterator;

  function Dict(iterable) {
    var dict = $.create(null);
    if (iterable != undefined) {
      if (isIterable(iterable)) {
        forOf(iterable, true, function (key, value) {
          dict[key] = value;
        });
      } else assign(dict, iterable);
    }
    return dict;
  }

  function reduce(object, mapfn, init) {
    aFunction(mapfn);
    var O = toIObject(object),
        keys = getKeys(O),
        length = keys.length,
        i = 0,
        memo,
        key;
    if (arguments.length < 3) {
      if (!length) throw TypeError('Reduce of empty object with no initial value');
      memo = O[keys[i++]];
    } else memo = Object(init);
    while (length > i) {
      if (has(O, key = keys[i++])) {
        memo = mapfn(memo, O[key], key, object);
      }
    }return memo;
  }
  function includes(object, el) {
    return (el == el ? keyOf(object, el) : findKey(object, function (it) {
      return it != it;
    })) !== undefined;
  }
  function get(object, key) {
    if (has(object, key)) return object[key];
  }
  function set(object, key, value) {
    if (DESCRIPTORS && key in Object) $.setDesc(object, key, createDesc(0, value));else object[key] = value;
    return object;
  }
  function isDict(it) {
    return isObject(it) && $.getProto(it) === Dict.prototype;
  }
  return {
    setters: [],
    execute: function () {
      $ = require('./$');
      ctx = require('./$.ctx');
      $export = require('./$.export');
      createDesc = require('./$.property-desc');
      assign = require('./$.object-assign');
      keyOf = require('./$.keyof');
      aFunction = require('./$.a-function');
      forOf = require('./$.for-of');
      isIterable = require('./core.is-iterable');
      $iterCreate = require('./$.iter-create');
      step = require('./$.iter-step');
      isObject = require('./$.is-object');
      toIObject = require('./$.to-iobject');
      DESCRIPTORS = require('./$.descriptors');
      has = require('./$.has');
      getKeys = $.getKeys;

      createDictMethod = function createDictMethod(TYPE) {
        var IS_MAP = TYPE == 1,
            IS_EVERY = TYPE == 4;
        return function (object, callbackfn, that) {
          var f = ctx(callbackfn, that, 3),
              O = toIObject(object),
              result = IS_MAP || TYPE == 7 || TYPE == 2 ? new (typeof this == 'function' ? this : Dict)() : undefined,
              key,
              val,
              res;
          for (key in O) {
            if (has(O, key)) {
              val = O[key];
              res = f(val, key, object);
              if (TYPE) {
                if (IS_MAP) result[key] = res;else if (res) switch (TYPE) {
                  case 2:
                    result[key] = val;
                    break;
                  case 3:
                    return true;
                  case 5:
                    return val;
                  case 6:
                    return key;
                  case 7:
                    result[res[0]] = res[1];
                } else if (IS_EVERY) return false;
              }
            }
          }return TYPE == 3 || IS_EVERY ? IS_EVERY : result;
        };
      };

      findKey = createDictMethod(6);

      createDictIter = function createDictIter(kind) {
        return function (it) {
          return new DictIterator(it, kind);
        };
      };

      DictIterator = function DictIterator(iterated, kind) {
        this._t = toIObject(iterated);
        this._a = getKeys(iterated);
        this._i = 0;
        this._k = kind;
      };

      $iterCreate(DictIterator, 'Dict', function () {
        var that = this,
            O = that._t,
            keys = that._a,
            kind = that._k,
            key;
        do {
          if (that._i >= keys.length) {
            that._t = undefined;
            return step(1);
          }
        } while (!has(O, key = keys[that._i++]));
        if (kind == 'keys') return step(0, key);
        if (kind == 'values') return step(0, O[key]);
        return step(0, [key, O[key]]);
      });Dict.prototype = null;$export($export.G + $export.F, { Dict: Dict });
      $export($export.S, 'Dict', {
        keys: createDictIter('keys'),
        values: createDictIter('values'),
        entries: createDictIter('entries'),
        forEach: createDictMethod(0),
        map: createDictMethod(1),
        filter: createDictMethod(2),
        some: createDictMethod(3),
        every: createDictMethod(4),
        find: createDictMethod(5),
        findKey: findKey,
        mapPairs: createDictMethod(7),
        reduce: reduce,
        keyOf: keyOf,
        includes: includes,
        has: has,
        get: get,
        set: set,
        isDict: isDict
      });
    }
  };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5wbS9jb3JlLWpzQDEuMi42L2xpYnJhcnkvbW9kdWxlcy9jb3JlLmRpY3QuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBOzs7OztBQXFGQSxXQUFTLElBQVQsQ0FBYyxRQUFkLEVBQXdCO0FBQ3RCLFFBQUksT0FBTyxFQUFFLE1BQUYsQ0FBUyxJQUFULENBQVAsQ0FEa0I7QUFFdEIsUUFBSSxZQUFZLFNBQVosRUFBdUI7QUFDekIsVUFBSSxXQUFXLFFBQVgsQ0FBSixFQUEwQjtBQUN4QixjQUFNLFFBQU4sRUFBZ0IsSUFBaEIsRUFBc0IsVUFBUyxHQUFULEVBQWMsS0FBZCxFQUFxQjtBQUN6QyxlQUFLLEdBQUwsSUFBWSxLQUFaLENBRHlDO1NBQXJCLENBQXRCLENBRHdCO09BQTFCLE1BS0UsT0FBTyxJQUFQLEVBQWEsUUFBYixFQUxGO0tBREY7QUFRQSxXQUFPLElBQVAsQ0FWc0I7R0FBeEI7O0FBYUEsV0FBUyxNQUFULENBQWdCLE1BQWhCLEVBQXdCLEtBQXhCLEVBQStCLElBQS9CLEVBQXFDO0FBQ25DLGNBQVUsS0FBVixFQURtQztBQUVuQyxRQUFJLElBQUksVUFBVSxNQUFWLENBQUo7UUFDQSxPQUFPLFFBQVEsQ0FBUixDQUFQO1FBQ0EsU0FBUyxLQUFLLE1BQUw7UUFDVCxJQUFJLENBQUo7UUFDQSxJQUpKO1FBS0ksR0FMSixDQUZtQztBQVFuQyxRQUFJLFVBQVUsTUFBVixHQUFtQixDQUFuQixFQUFzQjtBQUN4QixVQUFJLENBQUMsTUFBRCxFQUNGLE1BQU0sVUFBVSw4Q0FBVixDQUFOLENBREY7QUFFQSxhQUFPLEVBQUUsS0FBSyxHQUFMLENBQUYsQ0FBUCxDQUh3QjtLQUExQixNQUtFLE9BQU8sT0FBTyxJQUFQLENBQVAsQ0FMRjtBQU1BLFdBQU8sU0FBUyxDQUFUO0FBQ0wsVUFBSSxJQUFJLENBQUosRUFBTyxNQUFNLEtBQUssR0FBTCxDQUFOLENBQVgsRUFBNkI7QUFDM0IsZUFBTyxNQUFNLElBQU4sRUFBWSxFQUFFLEdBQUYs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QUksQ0FBSixFQUFPLE1BQU0sS0FBSyxLQUFLLEVBQUwsRUFBTCxDQUFOLENBQVIsRUFYa0M7QUFZM0MsWUFBSSxRQUFRLE1BQVIsRUFDRixPQUFPLEtBQUssQ0FBTCxFQUFRLEdBQVIsQ0FBUCxDQURGO0FBRUEsWUFBSSxRQUFRLFFBQVIsRUFDRixPQUFPLEtBQUssQ0FBTCxFQUFRLEVBQUUsR0FBRixDQUFSLENBQVAsQ0FERjtBQUVBLGVBQU8sS0FBSyxDQUFMLEVBQVEsQ0FBQyxHQUFELEVBQU0sRUFBRSxHQUFGLENBQU4sQ0FBUixDQUFQLENBaEIyQztPQUFYLENBQWxDLENBOEJBLEtBQUssU0FBTCxHQUFpQixJQUFqQixDQXdDQSxRQUFRLFFBQVEsQ0FBUixHQUFZLFFBQVEsQ0FBUixFQUFXLEVBQUMsTUFBTSxJQUFOLEVBQWhDO0FBQ0EsY0FBUSxRQUFRLENBQVIsRUFBVyxNQUFuQixFQUEyQjtBQUN6QixjQUFNLGVBQWUsTUFBZixDQUFOO0FBQ0EsZ0JBQVEsZUFBZSxRQUFmLENBQVI7QUFDQSxpQkFBUyxlQUFlLFNBQWYsQ0FBVDtBQUNBLGlCQUFTLGlCQUFpQixDQUFqQixDQUFUO0FBQ0EsYUFBSyxpQkFBaUIsQ0FBakIsQ0FBTDtBQUNBLGdCQUFRLGlCQUFpQixDQUFqQixDQUFSO0FBQ0EsY0FBTSxpQkFBaUIsQ0FBakIsQ0FBTjtBQUNBLGVBQU8saUJBQWlCLENBQWpCLENBQVA7QUFDQSxjQUFNLGlCQUFpQixDQUFqQixDQUFOO0FBQ0EsaUJBQVMsT0FBVDtBQUNBLGtCQUFVLGlCQUFpQixDQUFqQixDQUFWO0FBQ0EsZ0JBQVEsTUFBUjtBQUNBLGVBQU8sS0FBUDtBQUNBLGtCQUFVLFFBQVY7QUFDQSxhQUFLLEdBQUw7QUFDQSxhQUFLLEdBQUw7QUFDQSxhQUFLLEdBQUw7QUFDQSxnQkFBUSxNQUFSO09BbEJGIiwiZmlsZSI6Im5wbS9jb3JlLWpzQDEuMi42L2xpYnJhcnkvbW9kdWxlcy9jb3JlLmRpY3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiAqLyBcbid1c2Ugc3RyaWN0JztcbnZhciAkID0gcmVxdWlyZSgnLi8kJyksXG4gICAgY3R4ID0gcmVxdWlyZSgnLi8kLmN0eCcpLFxuICAgICRleHBvcnQgPSByZXF1aXJlKCcuLyQuZXhwb3J0JyksXG4gICAgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vJC5wcm9wZXJ0eS1kZXNjJyksXG4gICAgYXNzaWduID0gcmVxdWlyZSgnLi8kLm9iamVjdC1hc3NpZ24nKSxcbiAgICBrZXlPZiA9IHJlcXVpcmUoJy4vJC5rZXlvZicpLFxuICAgIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vJC5hLWZ1bmN0aW9uJyksXG4gICAgZm9yT2YgPSByZXF1aXJlKCcuLyQuZm9yLW9mJyksXG4gICAgaXNJdGVyYWJsZSA9IHJlcXVpcmUoJy4vY29yZS5pcy1pdGVyYWJsZScpLFxuICAgICRpdGVyQ3JlYXRlID0gcmVxdWlyZSgnLi8kLml0ZXItY3JlYXRlJyksXG4gICAgc3RlcCA9IHJlcXVpcmUoJy4vJC5pdGVyLXN0ZXAnKSxcbiAgICBpc09iamVjdCA9IHJlcXVpcmUoJy4vJC5pcy1vYmplY3QnKSxcbiAgICB0b0lPYmplY3QgPSByZXF1aXJlKCcuLyQudG8taW9iamVjdCcpLFxuICAgIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi8kLmRlc2NyaXB0b3JzJyksXG4gICAgaGFzID0gcmVxdWlyZSgnLi8kLmhhcycpLFxuICAgIGdldEtleXMgPSAkLmdldEtleXM7XG52YXIgY3JlYXRlRGljdE1ldGhvZCA9IGZ1bmN0aW9uKFRZUEUpIHtcbiAgdmFyIElTX01BUCA9IFRZUEUgPT0gMSxcbiAgICAgIElTX0VWRVJZID0gVFlQRSA9PSA0O1xuICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0LCBjYWxsYmFja2ZuLCB0aGF0KSB7XG4gICAgdmFyIGYgPSBjdHgoY2FsbGJhY2tmbiwgdGhhdCwgMyksXG4gICAgICAgIE8gPSB0b0lPYmplY3Qob2JqZWN0KSxcbiAgICAgICAgcmVzdWx0ID0gSVNfTUFQIHx8IFRZUEUgPT0gNyB8fCBUWVBFID09IDIgPyBuZXcgKHR5cGVvZiB0aGlzID09ICdmdW5jdGlvbicgPyB0aGlzIDogRGljdCkgOiB1bmRlZmluZWQsXG4gICAgICAgIGtleSxcbiAgICAgICAgdmFsLFxuICAgICAgICByZXM7XG4gICAgZm9yIChrZXkgaW4gTylcbiAgICAgIGlmIChoYXMoTywga2V5KSkge1xuICAgICAgICB2YWwgPSBPW2tleV07XG4gICAgICAgIHJlcyA9IGYodmFsLCBrZXksIG9iamVjdCk7XG4gICAgICAgIGlmIChUWVBFKSB7XG4gICAgICAgICAgaWYgKElTX01BUClcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gcmVzO1xuICAgICAgICAgIGVsc2UgaWYgKHJlcylcbiAgICAgICAgICAgIHN3aXRjaCAoVFlQRSkge1xuICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB2YWw7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgcmVzdWx0W3Jlc1swXV0gPSByZXNbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoSVNfRVZFUlkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICByZXR1cm4gVFlQRSA9PSAzIHx8IElTX0VWRVJZID8gSVNfRVZFUlkgOiByZXN1bHQ7XG4gIH07XG59O1xudmFyIGZpbmRLZXkgPSBjcmVhdGVEaWN0TWV0aG9kKDYpO1xudmFyIGNyZWF0ZURpY3RJdGVyID0gZnVuY3Rpb24oa2luZCkge1xuICByZXR1cm4gZnVuY3Rpb24oaXQpIHtcbiAgICByZXR1cm4gbmV3IERpY3RJdGVyYXRvcihpdCwga2luZCk7XG4gIH07XG59O1xudmFyIERpY3RJdGVyYXRvciA9IGZ1bmN0aW9uKGl0ZXJhdGVkLCBraW5kKSB7XG4gIHRoaXMuX3QgPSB0b0lPYmplY3QoaXRlcmF0ZWQpO1xuICB0aGlzLl9hID0gZ2V0S2V5cyhpdGVyYXRlZCk7XG4gIHRoaXMuX2kgPSAwO1xuICB0aGlzLl9rID0ga2luZDtcbn07XG4kaXRlckNyZWF0ZShEaWN0SXRlcmF0b3IsICdEaWN0JywgZnVuY3Rpb24oKSB7XG4gIHZhciB0aGF0ID0gdGhpcyxcbiAgICAgIE8gPSB0aGF0Ll90LFxuICAgICAga2V5cyA9IHRoYXQuX2EsXG4gICAgICBraW5kID0gdGhhdC5fayxcbiAgICAgIGtleTtcbiAgZG8ge1xuICAgIGlmICh0aGF0Ll9pID49IGtleXMubGVuZ3RoKSB7XG4gICAgICB0aGF0Ll90ID0gdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIHN0ZXAoMSk7XG4gICAgfVxuICB9IHdoaWxlICghaGFzKE8sIGtleSA9IGtleXNbdGhhdC5faSsrXSkpO1xuICBpZiAoa2luZCA9PSAna2V5cycpXG4gICAgcmV0dXJuIHN0ZXAoMCwga2V5KTtcbiAgaWYgKGtpbmQgPT0gJ3ZhbHVlcycpXG4gICAgcmV0dXJuIHN0ZXAoMCwgT1trZXldKTtcbiAgcmV0dXJuIHN0ZXAoMCwgW2tleSwgT1trZXldXSk7XG59KTtcbmZ1bmN0aW9uIERpY3QoaXRlcmFibGUpIHtcbiAgdmFyIGRpY3QgPSAkLmNyZWF0ZShudWxsKTtcbiAgaWYgKGl0ZXJhYmxlICE9IHVuZGVmaW5lZCkge1xuICAgIGlmIChpc0l0ZXJhYmxlKGl0ZXJhYmxlKSkge1xuICAgICAgZm9yT2YoaXRlcmFibGUsIHRydWUsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgZGljdFtrZXldID0gdmFsdWU7XG4gICAgICB9KTtcbiAgICB9IGVsc2VcbiAgICAgIGFzc2lnbihkaWN0LCBpdGVyYWJsZSk7XG4gIH1cbiAgcmV0dXJuIGRpY3Q7XG59XG5EaWN0LnByb3RvdHlwZSA9IG51bGw7XG5mdW5jdGlvbiByZWR1Y2Uob2JqZWN0LCBtYXBmbiwgaW5pdCkge1xuICBhRnVuY3Rpb24obWFwZm4pO1xuICB2YXIgTyA9IHRvSU9iamVjdChvYmplY3QpLFxuICAgICAga2V5cyA9IGdldEtleXMoTyksXG4gICAgICBsZW5ndGggPSBrZXlzLmxlbmd0aCxcbiAgICAgIGkgPSAwLFxuICAgICAgbWVtbyxcbiAgICAgIGtleTtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAzKSB7XG4gICAgaWYgKCFsZW5ndGgpXG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ1JlZHVjZSBvZiBlbXB0eSBvYmplY3Qgd2l0aCBubyBpbml0aWFsIHZhbHVlJyk7XG4gICAgbWVtbyA9IE9ba2V5c1tpKytdXTtcbiAgfSBlbHNlXG4gICAgbWVtbyA9IE9iamVjdChpbml0KTtcbiAgd2hpbGUgKGxlbmd0aCA+IGkpXG4gICAgaWYgKGhhcyhPLCBrZXkgPSBrZXlzW2krK10pKSB7XG4gICAgICBtZW1vID0gbWFwZm4obWVtbywgT1trZXldLCBrZXksIG9iamVjdCk7XG4gICAgfVxuICByZXR1cm4gbWVtbztcbn1cbmZ1bmN0aW9uIGluY2x1ZGVzKG9iamVjdCwgZWwpIHtcbiAgcmV0dXJuIChlbCA9PSBlbCA/IGtleU9mKG9iamVjdCwgZWwpIDogZmluZEtleShvYmplY3QsIGZ1bmN0aW9uKGl0KSB7XG4gICAgcmV0dXJuIGl0ICE9IGl0O1xuICB9KSkgIT09IHVuZGVmaW5lZDtcbn1cbmZ1bmN0aW9uIGdldChvYmplY3QsIGtleSkge1xuICBpZiAoaGFzKG9iamVjdCwga2V5KSlcbiAgICByZXR1cm4gb2JqZWN0W2tleV07XG59XG5mdW5jdGlvbiBzZXQob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIGlmIChERVNDUklQVE9SUyAmJiBrZXkgaW4gT2JqZWN0KVxuICAgICQuc2V0RGVzYyhvYmplY3QsIGtleSwgY3JlYXRlRGVzYygwLCB2YWx1ZSkpO1xuICBlbHNlXG4gICAgb2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgcmV0dXJuIG9iamVjdDtcbn1cbmZ1bmN0aW9uIGlzRGljdChpdCkge1xuICByZXR1cm4gaXNPYmplY3QoaXQpICYmICQuZ2V0UHJvdG8oaXQpID09PSBEaWN0LnByb3RvdHlwZTtcbn1cbiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5GLCB7RGljdDogRGljdH0pO1xuJGV4cG9ydCgkZXhwb3J0LlMsICdEaWN0Jywge1xuICBrZXlzOiBjcmVhdGVEaWN0SXRlcigna2V5cycpLFxuICB2YWx1ZXM6IGNyZWF0ZURpY3RJdGVyKCd2YWx1ZXMnKSxcbiAgZW50cmllczogY3JlYXRlRGljdEl0ZXIoJ2VudHJpZXMnKSxcbiAgZm9yRWFjaDogY3JlYXRlRGljdE1ldGhvZCgwKSxcbiAgbWFwOiBjcmVhdGVEaWN0TWV0aG9kKDEpLFxuICBmaWx0ZXI6IGNyZWF0ZURpY3RNZXRob2QoMiksXG4gIHNvbWU6IGNyZWF0ZURpY3RNZXRob2QoMyksXG4gIGV2ZXJ5OiBjcmVhdGVEaWN0TWV0aG9kKDQpLFxuICBmaW5kOiBjcmVhdGVEaWN0TWV0aG9kKDUpLFxuICBmaW5kS2V5OiBmaW5kS2V5LFxuICBtYXBQYWlyczogY3JlYXRlRGljdE1ldGhvZCg3KSxcbiAgcmVkdWNlOiByZWR1Y2UsXG4gIGtleU9mOiBrZXlPZixcbiAgaW5jbHVkZXM6IGluY2x1ZGVzLFxuICBoYXM6IGhhcyxcbiAgZ2V0OiBnZXQsXG4gIHNldDogc2V0LFxuICBpc0RpY3Q6IGlzRGljdFxufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
